% Author: Juan M. Gandarias
% Assistant Professor 
% University of Malaga
% email: jmgandarias@uma.es
% web: jmgandarias.com
%
% Inspired by the memorithesis template authored by Victor Baena
%

% Packages list
\usepackage{import}
\usepackage[T1]{fontenc} 
\usepackage{lipsum}					
\usepackage[centertags]{amsmath}
\usepackage{amsfonts} 		
\usepackage{stmaryrd}					
\usepackage{amssymb}					
\usepackage{amsthm}					
\usepackage{newlfont}					
\usepackage{layouts}					
\usepackage{graphicx}					
\usepackage{longtable,rotating}			
\usepackage[utf8]{inputenc}			
\usepackage{colortbl}					
\usepackage{wasysym}					
\usepackage{mathrsfs}					
\usepackage{float}						
\usepackage{upgreek}					
\usepackage{latexsym}					
\usepackage{natbib}		
\usepackage{url}						
\usepackage{color}                    				
\usepackage{memhfixc}					
\usepackage{enumerate}					
\usepackage{footnote}					
\usepackage{microtype}					
\usepackage{rotfloat}					
\usepackage{alltt}						
\usepackage{lmodern}
\usepackage[spanish]{babel} 
\usepackage{fancyhdr}
\usepackage{mathtools}
\usepackage{verbatim}
\usepackage{pdfpages}
\usepackage{tocbibind}
\usepackage{subfig}
\usepackage{anysize}
\usepackage{titlesec}
\usepackage{eurosym}
\usepackage{parskip}
\usepackage{cite}
\usepackage{hyperref}	
\usepackage{listings}
\usepackage{lettrine}
\usepackage[paper=a4paper,left=30mm,right=30mm,top=30mm,bottom=30mm]{geometry}
				
% Better page layout for A4 paper, see memoir manual.
\settrimmedsize{297mm}{210mm}{*}
\setlength{\trimtop}{0pt} 
\setlength{\trimedge}{\stockwidth} 
\addtolength{\trimedge}{-\paperwidth} 
\settypeblocksize{634pt}{448.13pt}{*} 
\setulmargins{4cm}{*}{*} 
\setlrmargins{*}{*}{1.5} 
\setmarginnotes{17pt}{51pt}{\onelineskip} 
\setheadfoot{\onelineskip}{2\onelineskip} 
\setheaderspaces{*}{2\onelineskip}{*} 
\checkandfixthelayout
%
\frenchspacing

% Note: This is automatically set by memoir class. Nevertheless \OnehalfSpacing 
% enables double spacing but leaves single spaced for captions for instance. 
\OnehalfSpacing 
%
% Sets numbering division level
\setsecnumdepth{subsection} 
\maxsecnumdepth{subsubsection}
%
% Chapter style (taken and slightly modified from Lars Madsen Memoir Chapter 
% Styles document
\usepackage{calc,soul,fourier}
\makeatletter 
\newlength\dlf@normtxtw 
\setlength\dlf@normtxtw{\textwidth} 
\newsavebox{\feline@chapter} 
\newcommand\feline@chapter@marker[1][4cm]{%
	\sbox\feline@chapter{% 
		\resizebox{!}{#1}{\fboxsep=1pt%
			\colorbox{uma_pink}{\color{white}\thechapter}% 
		}}%
		\rotatebox{90}{% 
			\resizebox{%
				\heightof{\usebox{\feline@chapter}}+\depthof{\usebox{\feline@chapter}}}% 
			{!}{\scshape\so\@chapapp}}\quad%
		\raisebox{\depthof{\usebox{\feline@chapter}}}{\usebox{\feline@chapter}}%
} 
\newcommand\feline@chm[1][4cm]{%
	\sbox\feline@chapter{\feline@chapter@marker[#1]}% 
	\makebox[0pt][c]{% aka \rlap
		\makebox[1cm][r]{\usebox\feline@chapter}%
	}}
\makechapterstyle{daleifmodif}{
	\renewcommand\chapnamefont{\sffamily\HUGE\scshape\raggedleft\so} 
	\renewcommand\chaptitlefont{\sffamily\HUGE\bfseries\scshape} 
	\renewcommand\chapternamenum{} \renewcommand\printchaptername{} 
	\renewcommand\printchapternum{\null\hfill\feline@chm[2.5cm]\par} 
	\renewcommand\afterchapternum{\par\vskip\midchapskip} 
	\renewcommand\printchaptertitle[1]{\color{uma_blue_dark}\chaptitlefont\raggedleft ##1\par}
} 
\makeatother 
\chapterstyle{daleifmodif}

% The pages are numbered consecutively at the bottom centre of the
% page.
\makepagestyle{myvf} 
\makeoddfoot{myvf}{}{\thepage}{} 
\makeevenfoot{myvf}{}{\thepage}{} 
\makeheadrule{myvf}{\textwidth}{\normalrulethickness} 
\makeevenhead{myvf}{\small\textsf{\textcolor{uma_gray_dark}{\leftmark}}}{}{} 
\makeoddhead{myvf}{}{}{\small\textsf{\textcolor{uma_gray_dark}{\tfeTitle}}}
\pagestyle{myvf}

% Fills blank pages until next odd-numbered page. Used to emulate single-sided
% frontmatter. This will work for title, abstract and declaration. Though the
% contents sections will each start on an odd-numbered page they will
% spill over onto the even-numbered pages if extending beyond one page
% (hopefully, this is ok).
\newcommand{\clearemptydoublepage}{\newpage{\thispagestyle{empty}\cleardoublepage}}

% Creates indexes for Table of Contents, List of Figures, List of Tables and Index
\makeindex
% \printglossaries below creates a list of abbreviations. \gls and related
% commands are then used throughout the text, so that latex can automatically
% keep track of which abbreviations have already been defined in the text.

%Reduce widows  (the last line of a paragraph at the start of a page) and orphans 
% (the first line of paragraph at the end of a page)
\widowpenalty=1000
\clubpenalty=1000

%An initial of the very first character of the content
\newcommand{\initial}[1]{%
	\lettrine[lines=3,lhang=0.2, nindent=0.5em]{
		\color{uma_blue_dark}
     		{#1}}{}}

% Default family font: sf
\renewcommand{\familydefault}{\sfdefault}

% Defines a new command for the horizontal lines, change thickness here
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} %

% Official UMA colors https://www.uma.es/servicio-comunicacion/info/1946/marcas-oficiales/?set_language=es
\definecolor{uma_blue_dark}{RGB}{0,46,93}
\definecolor{uma_blue_light}{RGB}{43,145,208}
\definecolor{uma_blue_water}{RGB}{0,174,199}
\definecolor{uma_gray_light}{RGB}{136,139,141}
\definecolor{uma_gray_dark}{RGB}{99,102,106}
\definecolor{uma_purple}{RGB}{88,39,135}
\definecolor{uma_pink}{RGB}{204,0,102}
\definecolor{uma_green}{RGB}{121,193,70}
\definecolor{uma_yellow}{RGB}{255,233,84}

% Enable colored hyperlinks
\hypersetup{
    colorlinks=true,
    citecolor=uma_pink,
    linkcolor=uma_blue_light,
    filecolor=uma_blue_water,      
    urlcolor=uma_blue_light
}

% If you want to write pieces of code
\definecolor{gray97}{gray}{.97}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}
\lstset{ frame=Ltb,
framerule=0pt,
aboveskip=0.5cm,
framextopmargin=3pt,
framexbottommargin=3pt,
framexleftmargin=0.4cm,
framesep=0pt,
rulesep=.4pt,
backgroundcolor=\color{gray97},
rulesepcolor=\color{black},
stringstyle=\ttfamily,
showstringspaces = false,
basicstyle=\small\ttfamily,
commentstyle=\color{gray45},
keywordstyle=\bfseries,
numbers=left,
numbersep=15pt,
numberstyle=\tiny,
numberfirstline = false,
breaklines=true,
}

\lstnewenvironment{listing}[1][]
{\lstset{#1}\pagebreak[0]}{\pagebreak[0]}

\lstdefinestyle{consola}
{basicstyle=\scriptsize\bf\ttfamily,
backgroundcolor=\color{gray75},
}

\lstdefinestyle{C}
{language=C,
}

% Have also the subsubsections numbered in the table of contents						
\setcounter{secnumdepth}{3} 

% Indentation length
\setlength{\parindent}{4mm}

% Add table of contets, list of figures and list of tables with specific names
\addtocontents{toc}{\par\nobreak \mbox{}\hfill{\bf Página}\par\nobreak}
\addtocontents{lof}{\par\nobreak\textbf{{Figura} \hfill \textsf{Página}}\par\nobreak}
\addtocontents{lot}{\par\nobreak\textbf{{Tabla} \hfill \textsf{Página}}\par\nobreak}





